---
layout: post
title: Bris
subtitle: High-Resolution Probabilistic Data-Driven Weather Modeling
cover-img: /assets/img/weather-generator/weathergenerator_cover.png
thumbnail-img: /assets/img/weather-generator/weathergenerator_logo.png
share-img: /assets/img/weather-generator/weathergenerator_logo.png
gh-repo: evenmn/evenmn.github.io
gh-badge: [follow]
tags: [Bris, weather, forecasting, machine learning, data-driven models]
comments: true
mathjax: true
author: Even Nordhagen
---

Data-driven weather forecasting has over the last few years stunned people, showing competetive predictions at the fraction of the cost of conventional state-of-the-art models. However, most data-driven models are trained on ERA5 with ~31 km horizontal resolution. Is it possible to replicate the results in a high-resolution configuration/setting?

In a recent work, we at the Norwegian Meteorological Institute have, in collaboration with people from the European Centre for Medium-range Weather Forecasting (ECMWF), trained a probabilistic data-driven model on the MetCoOp Ensemble Prediction System (MEPS) analysis at 2.5 km. To obtain physical realistic scenarios, we had to invent a combined physical-spectral probabilistic training objective. The final model performs similar to the forecasts of MEPS, but at a 20-30 speed-up. In this post, we will dive into the dirty details behind the implementation and training of this model, and the plan going forward.

I will try to write the post in a popular scientific language. If you prefer a more academic read, I refer to [our recent preprint](http://arxiv.org/abs/2511.23043v). The methodology is based on the stretched-grid approach, which was discussed in [an earlier post](https://evennordhagen.com/2024-09-12-stretched-grid/). 

(Make some cool figure in Diana - also for cover photo)
<div class="text-center">
    <img src="/assets/img/weather-generator/wg_illustration.png" alt="WeatherGenerator" style="width: 70%;">
</div>

# Why high resolution?
First, you might wonder why we bother developing high resolution models? Aren't the state-of-the-art models at lower resolution good enough? The answer yes and no, depending on the situation. Certain weather events, such as rain showers and winds, vary largely locally, and high resolution is therefore crucial to capture local variations. This is why national meteorological and
hydrological services (NMHSes) are typically developing high-resolution weather models.

On the other hand, some meteorological variables, like mean sea level pressure, primarily reflects large-scale (synoptic) mass distribution. For that, the benefit of high-resolution predictions is minor or even absent. To build upon this claim, we below compare Bris (2.5km resolution) to ECMWF's data-driven model at 31km, AIFS-CRPS {lang2024}:

(Figure showing Bris vs. AIFS-CRPS)
*Continuous Ranked Probability Score (CRPS) for 2m temperature, 10m wind speed, 6-hour accumulated precipication and mean sea level pressure - A comparison of Bris and AIFS-CRPS. The two models are compared against synoptic stations in Norway. Lower is better.*

Continuous Ranked Probability Score (CRPS) is a proper scoring rule for probabilistic predictions, but for now just view it as an objective metric for the models (we will talk more about CRPS below). What we see is that Bris has a significantly better score for temperature, wind speed and precipitation, but is worse at mean sea level pressure. Please keep in mind that AIFS-CRPS is the state-of-the-art global data-driven model, so the purpose here is solely to show the benefit of a high-resolution model. Resolution is important.

As a consequence, high-resolution is important for extreme weather preditions like heavy precipitation and storms, threatening millions of people in Europe every year. As the core responsibility of NHMSes is saving lives and property, we need high-resolution models.

(The butterfly effect illustration, ChatGPT?)

# Why probabilistic?
In the choice of making a model for weather prediction, one can either create a deterministic model, providing a single realization, or one can make a model that says something about the *probabilities* of different scenarios. Importantly, the atmosphere is a chaotic system due to stochastic physics that cannot be predicted, due to turbulence among other effects. In chaos theory, the atmospheric dynamics is a level 1 chaotic system, meaning that it is govern by stochastic processes that cannot be affected by our actions. The stock market is an example of a level 2 chaotic system where our current actions will have an impact of the future dynamics of the system. 

And even if the atmosphere was totally deterministic, we would still have uncertainties in the measurements, making the initial conditions uncertain. For these reasons, it makes more sense predicting probabilities than just a single forecast.

Probabilistic predictions have three main benefits over deterministic ones:

1. Uncertainty estimations
2. Sharp fields
3. Can capture extreme events

(Show fields to prove that they are sharp)

The chaotic nature of atmospheric dynamics was known already in the 1960s when the butterfly effect was introduced by Lorentz {Lorentz}, but it was only from the mid 1990s we could afford probabilistic forecasts. Probabilistic models are typically ensemble prediction systems (EPS), where an ensemble of realizations is generated. We assume that each ensemble member is drawn from the true marginal distribution, such that each realization is considered as equally likely and the probability of a given weather event is found from clustering. 

We model the system as a 2nd order Markov system, where one state depends on the two previous states only. Mathematically, it can be be described by:

(joint probability distribution, math)

Deterministic models, on the other hand, typically aim for minimizing the mean squared error, providing a forecast that contains the mean of all possible weather scenarios, but, importantly, **not** the most likely realization. In fact, deterministic forecasts rarely correspond to a likely weather realization because of the double penalty effect associated with L-optimization.

# How does it work?

## Architecture
Encoder-processor-decoder

Graph neural network (GNN)

Ensemble prediction system (EPS)

(Show Fig.1 from preprint)

## Training objective
CRPS 

### Spatial coherence
FFT

# Selected results

(Spread-skill?)

# Conclusions

WeatherGenerator aims to build the next generation of weather‑forecasting models. This is crucial for warning against increasingly frequent extreme weather events and for maintaining Europe’s position as a world leader in global weather prediction. Given Europe’s unparalleled meteorological datasets and HPC resources, there is good reason to believe we can achieve this.

For more information, see the official ECMWF blog post.

![Signature](/assets/img/signature.png){: .mx-auto.d-block :}

Feel free to leave a comment or question below.

*The WeatherGenerator project (grant agreement No. 101187947) is funded by the European Union. Views and opinions expressed are those of the author(s) only and do not necessarily reflect those of the European Union or the Commission.*

![Funded by EU](/assets/img/weather-generator/EN-Funded by the EU-POS.png){: .mx-auto.d-block :}

## References
{% bibliography --file weathergenerator %}
