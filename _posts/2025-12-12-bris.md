---
layout: post
title: Bris
subtitle: High-Resolution Probabilistic Data-Driven Weather Modeling
cover-img: /assets/img/bris/diana.png
thumbnail-img: /assets/img/bris/bris.png
share-img: /assets/img/bris/bris.png
gh-repo: evenmn/evenmn.github.io
gh-badge: [follow]
tags: [Bris, weather, forecasting, machine learning, data-driven models]
comments: true
mathjax: true
author: Even Nordhagen
---

(Can we replicate the recent success of data-driven weather prediction in a high-resolution configuration?)

Data-driven weather forecasting has over the last few years stunned people, showing competetive predictions at the fraction of the cost of conventional state-of-the-art models. However, most data-driven models are trained on ERA5 with ~31 km horizontal resolution. Is it possible to replicate the results in a high-resolution setting?

We introduce Bris - a high-resolution probabilistic data-driven model trained on the MetCoOp Ensemble Prediction System (MEPS) analysis at 2.5 km. Bris means *breeze* in Norwegian, and is also pronounced similarly (no abbreviation/acronym). The work is carried out at the Norwegian Meteorological Institute in collaboration with the European Centre for Medium-range Weather Forecasting (ECMWF).

To obtain physical realizations, we had to invent a combined physical-spectral probabilistic training objective. The final model performs similar to the forecasts of MEPS, but at a 20-30 speed-up. In this post, we will dive into the dirty details behind the implementation and training of this model, and the plan going forward.

I will try to write the post in a popular scientific language. If you prefer a more academic read, I refer to [our recent preprint](http://arxiv.org/abs/2511.23043v). The methodology is based on the stretched-grid approach, which was discussed in [an earlier post](https://evennordhagen.com/2024-09-12-stretched-grid/). 

<div class="text-center">
    <img src="/assets/img/bris/diana.png" alt="Bris" style="width: 70%;">
</div>
*Example field*

# Why high resolution?
First, you might wonder why we bother developing high resolution models? Aren't the state-of-the-art models at lower resolution good enough? The answer yes and no, depending on the situation. Certain weather events, such as rain showers and winds, vary largely locally, and high resolution is therefore crucial to capture local variations. This is why national meteorological and
hydrological services (NMHSes) are typically developing high-resolution weather models.

On the other hand, some meteorological variables, like mean sea level pressure, primarily reflects large-scale (synoptic) mass distribution. For that, the benefit of high-resolution predictions is minor or even absent. To build upon this claim, we below compare Bris (2.5km resolution) to ECMWF's data-driven model at 31km, AIFS-CRPS {% cite lang2024a %}:

<div class="text-center">
    <img src="/assets/img/bris/crps.png" alt="Bris" style="width: 70%;">
</div>
*Continuous Ranked Probability Score (CRPS) for 2m temperature, 10m wind speed, 6-hour accumulated precipication and mean sea level pressure - A comparison of Bris and AIFS-CRPS. The two models are compared against synoptic stations in Norway. Lower is better.*

Continuous Ranked Probability Score (CRPS) is a proper scoring rule for probabilistic predictions, but for now just view it as an objective metric for the models (we will talk more about CRPS below). What we see is that Bris has a significantly better score for temperature, wind speed and precipitation, but is worse at mean sea level pressure. Please keep in mind that AIFS-CRPS is the state-of-the-art global data-driven model, so the purpose here is solely to show the benefit of a high-resolution model. Resolution is important.

As a consequence, high-resolution is important for extreme weather preditions like heavy precipitation and storms, threatening millions of people in Europe every year. As the core responsibility of NHMSes is saving lives and property, we need high-resolution models.

<video autoplay loop muted playsinline preload="metadata" width="720" controls playsinline muted>
  <source src="/assets/img/bris/lorenz_web.mp4" type="video/mp4">
</video>
*The Lorenz system is often used to demonstrate the atmosphere's chaotic behavior and sensitivity to initial conditions. Here, we simulate the dynamics of two nearly identical initial conditions (blue trajectory is perturbed 0.00000001 in x-direction with reference to the orange one). Note how difference the behavior is already after 40 time units. This effect is called the butterfly effect.*

# Why probabilistic?
In the choice of making a model for weather prediction, one can either create a deterministic model, providing a single realization, or one can make a model that says something about the *probabilities* of different scenarios. Importantly, the atmosphere is a chaotic system due to stochastic physics that cannot be predicted, due to turbulence among other effects. In chaos theory, the atmospheric dynamics is a level 1 chaotic system, meaning that it is govern by stochastic processes that cannot be affected by our actions. The stock market is an example of a level 2 chaotic system where our current actions will have an impact of the future dynamics of the system. 

And even if the atmosphere was totally deterministic, we would still have uncertainties in the measurements, making the initial conditions uncertain. Edward Lorenz illustrates the effect of a small change in initial conditions with a set of deterministic differential equations, demonstrating that an infinitesimal perturbation of the initial state can completely change the behavior of the system (see animation above). This effect is known as the butterfly effect for two reasons: First, even a small butterfly affects the atmosphere and a butterfly flap can make the atmosphere very different at a later point. In the extreme, a butterfly flap can cause a storm on the other side of Earth a week later. Second, when similating Lorenz' equations with his initial conditions, the trajectories draw a butterfly seen from the right orientation (see above).

The uncertainty in initial conditions together with the stochastic nature of the atmosphere makes the atmosphere inherit unpredictable. For these reasons, it makes more sense predicting probabilities than just a single forecast.

Probabilistic predictions have three main benefits over deterministic ones:

1. Uncertainty estimations
2. Sharp fields
3. Can capture extreme events

<div class="text-center">
    <img src="/assets/img/bris/precip_fields.png" alt="Bris" style="width: 70%;">
</div>
*Precipitation fields over parts of the Nordics at 2.5 km horizontal resolution. Each panel represent different
forecasting models: (a) is the MEPS model (reference), (b) is a deterministic model, (c) is Bris trained with a simplified loss function and (d) is what we in this post refer to as Bris. Note the smoothing in (b) and the small-scale noise in (c).*

The chaotic nature of atmospheric dynamics was known already in the 1960s when the butterfly effect was introduced by Lorenz {% cite lorenz1963 %}, but it was only from the mid 1990s we could afford probabilistic forecasts. Probabilistic models are typically ensemble prediction systems (EPS), where an ensemble of realizations is generated. (think about two members, where one represents the orange trajectory above and the other represent the blue). We assume that each ensemble member is drawn from the true marginal distribution, such that each realization is considered as equally likely and the probability of a given weather event is found from clustering.

=== Move this to 'How does it work?'? ===
We model the system as a 2nd order Markov system, where one state depends on the two previous states only. Mathematically, it can be be described by:

(joint probability distribution, math)

Deterministic models, on the other hand, typically aim for minimizing the mean squared error, providing a forecast that contains the mean of all possible weather scenarios, but, importantly, **not** the most likely realization. In fact, deterministic forecasts rarely represent likely weather realizations because of the double penalty effect associated with L-optimization.

# How does it work?
Now over to how this works. 

## Architecture
### Encoder-processor-decoder

The Bris model follows an encoder-processor-decoder design, like most of the recent data-driven models for weather prediction {% cite bi2023 bonev2025 lam2023 lang2024a %}. The idea here is to encode the input fields into a virtual latent state. In the latent space, there is a processor responsible for exchange information between variables and between points in space. Then, the latent state is decoded back to real space. 

### Graph neural network (GNN)
A graph consists of position dependent nodes and edges connecting the nodes. 
What's crucial to understand here, is that the model lives in the edges only

<div class="text-center">
    <img src="/assets/img/bris/model.pdf" alt="WeatherGenerator" style="width: 70%;">
</div>
*Schematic diagram of the ensemble training. (a) The preceding (t−6h) and the current (t0h) states from MEPS and ERA5 are used as inputs to the model. The inputs are replicated M times, where M is the number of ensemble members during training. (b) The model has an encoder-processor-decoder architecture, where noise (z) is injected into the latent space for stochasticity. (c) The predictions are evaluated against targets using a point-wise and spectral training objective.*

Ensemble prediction system (EPS)

## Training objective
CRPS 

### Spatial coherence
FFT

# Bris vs MEPS
(Spread-skill?)

# Operational 

# Conclusions
WeatherGenerator aims to build the next generation of weather‑forecasting models. This is crucial for warning against increasingly frequent extreme weather events and for maintaining Europe’s position as a world leader in global weather prediction. Given Europe’s unparalleled meteorological datasets and HPC resources, there is good reason to believe we can achieve this.

For more information, see the official ECMWF blog post.

![Signature](/assets/img/signature.png){: .mx-auto.d-block :}

Feel free to leave a comment or question below.

*The WeatherGenerator project (grant agreement No. 101187947) is funded by the European Union. Views and opinions expressed are those of the author(s) only and do not necessarily reflect those of the European Union or the Commission.*

![Funded by EU](/assets/img/weather-generator/EN-Funded by the EU-POS.png){: .mx-auto.d-block :}

## References
{% bibliography --file bris %}
