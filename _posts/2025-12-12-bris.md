---
layout: post
title: Bris
subtitle: High-Resolution Probabilistic Data-Driven Weather Modeling
cover-img: /assets/img/weather-generator/weathergenerator_cover.png
thumbnail-img: /assets/img/weather-generator/weathergenerator_logo.png
share-img: /assets/img/weather-generator/weathergenerator_logo.png
gh-repo: evenmn/evenmn.github.io
gh-badge: [follow]
tags: [Bris, weather, forecasting, machine learning, data-driven models]
comments: true
mathjax: true
author: Even Nordhagen
---

Data-driven weather forecasting has over the last few years stunned people, showing competetive predictions at the fraction of the cost of conventional state-of-the-art models. However, most data-driven models are trained on ERA5 with ~31 km horizontal resolution. Is it possible to replicate the results in a high-resolution configuration/setting?

In a recent work, we at the Norwegian Meteorological Institute have, in collaboration with people from the European Centre for Medium-range Weather Forecasting (ECMWF), trained a probabilistic data-driven model on the MetCoOp Ensemble Prediction System (MEPS) analysis at 2.5 km. To obtain physical realistic scenarios, we had to invent a combined physical-spectral probabilistic training objective. The final model performs similar to the forecasts of MEPS, but at a 20-30 speed-up. In this post, we will dive into the dirty details behind the implementation and training of this model, and the plan going forward.

I will try to write the post in a popular scientific language. If you prefer a more academic read, I refer to [our recent preprint](http://arxiv.org/abs/2511.23043v). The methodology is based on the stretched-grid approach, which was discussed in [an earlier post](https://evennordhagen.com/2024-09-12-stretched-grid/). 

(Make some cool figure in Diana - also for cover photo)
<div class="text-center">
    <img src="/assets/img/weather-generator/wg_illustration.png" alt="WeatherGenerator" style="width: 70%;">
</div>

# Why high resolution?
First, you might wonder why we bother developing high resolution models? Aren't the state-of-the-art models at lower resolution good enough? The answer yes and no, depending on the situation. Certain weather events, such as rain showers and winds, vary largely locally, and high resolution is therefore crucial to capture local variations. This is why national meteorological and
hydrological services (NMHSes) are typically developing high-resolution weather models.

On the other hand, some meteorological variables, like mean sea level pressure, primarily reflects large-scale (synoptic) mass distribution. For that, the benefit of high-resolution predictions is minor or even absent. To build upon this claim, we below compare Bris (2.5km resolution) to ECMWF's data-driven model at 31km, AIFS-CRPS {lang2024}:

(Figure showing Bris vs. AIFS-CRPS)
*Continuous Ranked Probability Score (CRPS) for 2m temperature, 10m wind speed, 6-hour accumulated precipication and mean sea level pressure - A comparison of Bris and AIFS-CRPS. The two models are compared against synoptic stations in Norway. Lower is better.*

Continuous Ranked Probability Score (CRPS) is a proper scoring rule for probabilistic predictions, but for now just view it as an objective metric for the models (we will talk more about CRPS below). What we see is that Bris has a significantly better score for temperature, wind speed and precipitation, but is worse at mean sea level pressure. Please keep in mind that AIFS-CRPS is the state-of-the-art global data-driven model, so the purpose here is solely to show the benefit of a high-resolution model. Resolution is important.

As a consequence, high-resolution is important for extreme weather preditions like heavy precipitation and storms, threatening millions of people in Europe every year. As the core responsibility of NHMSes is saving lives and property, we need high-resolution models.

# Why probabilistic?
Bris is a probabilistic model, instead of deterministic. NWP transformed from deterministic to ensemble prediction system in 1990-2000.

Stochastic physics/processes in the atmosphere makes the system chaotic (level 1 chaos in chaos theory). Makes sense so model atmosphere with a stochastic model. We model the system as a 2nd order Markov system, where one state depends on the two previous states only. 

(joint probability distribution, math)

1. Uncertainty estimations
2. Sharp fields
3. Extreme weather predictions

(Mention CRPS here, show equation)

(Show fields to prove that they are sharp)

# How does it work?

## Architecture
Encoder-processor-decoder

Graph neural network (GNN)

Ensemble prediction system (EPS)

(Show Fig.1 from preprint)

# Spatial coherence
FFT

# Selected results

(Spread-skill?)

# Conclusions

WeatherGenerator aims to build the next generation of weather‑forecasting models. This is crucial for warning against increasingly frequent extreme weather events and for maintaining Europe’s position as a world leader in global weather prediction. Given Europe’s unparalleled meteorological datasets and HPC resources, there is good reason to believe we can achieve this.

For more information, see the official ECMWF blog post.

![Signature](/assets/img/signature.png){: .mx-auto.d-block :}

Feel free to leave a comment or question below.

*The WeatherGenerator project (grant agreement No. 101187947) is funded by the European Union. Views and opinions expressed are those of the author(s) only and do not necessarily reflect those of the European Union or the Commission.*

![Funded by EU](/assets/img/weather-generator/EN-Funded by the EU-POS.png){: .mx-auto.d-block :}

## References
{% bibliography --file weathergenerator %}
